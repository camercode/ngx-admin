/**
          * @ag-grid-enterprise/row-grouping - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.1
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
/**
          * @ag-grid-enterprise/row-grouping - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.2.1
          * @link http://www.ag-grid.com/
          * @license Commercial
          */
import{_ as e,Autowired as t,Bean as o,BeanStub as n,NumberSequence as r,RowNode as i,PostConstruct as a,Events as s,DragSourceType as u,DragAndDropService as l,KeyCode as p,TouchListener as c,VirtualList as d,Optional as h,RefSelector as g,Component as f,ManagedFocusFeature as v,PositionableFeature as m,HorizontalDirection as y,VerticalDirection as C,Constants as A,ModuleNames as G}from"@ag-grid-community/core";import{EnterpriseCoreModule as D}from"@ag-grid-enterprise/core";var E,O=(E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),N=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},P=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return O(r,n),r.prototype.execute=function(t){var o=e.missingOrEmpty(this.columnModel.getValueColumns()),n=!this.gridOptionsWrapper.getGroupRowAggFunc(),r=t.changedPath&&t.changedPath.isActive();if(!(o&&n&&r)){var i=this.createAggDetails(t);this.recursivelyCreateAggData(i)}},r.prototype.createAggDetails=function(e){var t=this.columnModel.isPivotActive(),o=this.columnModel.getValueColumns(),n=t?this.columnModel.getPivotColumns():[];return{changedPath:e.changedPath,valueColumns:o,pivotColumns:n}},r.prototype.recursivelyCreateAggData=function(e){var t=this;this.filteredOnly=!this.gridOptionsWrapper.isSuppressAggFilteredOnly();e.changedPath.forEachChangedNodeDepthFirst((function(o){if(!o.hasChildren())o.aggData&&o.setAggData(null);else{if(-1===o.level){var n=!t.columnModel.isPivotMode();if(t.gridOptionsWrapper.isSuppressAggAtRootLevel()&&n)return}t.aggregateRowNode(o,e)}}),!0)},r.prototype.aggregateRowNode=function(e,t){var o,n=0===t.valueColumns.length,r=0===t.pivotColumns.length,i=this.gridOptionsWrapper.getGroupRowAggFunc();i?o=i({nodes:e.childrenAfterFilter}):o=n?null:r?this.aggregateRowNodeUsingValuesOnly(e,t):this.aggregateRowNodeUsingValuesAndPivot(e);e.setAggData(o),e.sibling&&e.sibling.setAggData(o)},r.prototype.aggregateRowNodeUsingValuesAndPivot=function(t){var o=this,n={},r=this.pivotStage.getPivotColumnDefs();return r.filter((function(t){return!e.exists(t.pivotTotalColumnIds)})).forEach((function(e){var r,i=e.pivotKeys||[],a=e.pivotValueColumn,s=e.colId;r=t.leafGroup?o.getValuesFromMappedSet(t.childrenMapped,i,a):o.getValuesPivotNonLeaf(t,s),n[s]=o.aggregateValues(r,a.getAggFunc(),a,t)})),r.filter((function(t){return e.exists(t.pivotTotalColumnIds)})).forEach((function(e){var r=[],i=e.pivotValueColumn,a=e.pivotTotalColumnIds,s=e.colId;a&&a.length&&(a.forEach((function(e){r.push(n[e])})),n[s]=o.aggregateValues(r,i.getAggFunc(),i,t))})),n},r.prototype.aggregateRowNodeUsingValuesOnly=function(e,t){var o=this,n={},r=t.changedPath.isActive()?t.changedPath.getValueColumnsForNode(e,t.valueColumns):t.valueColumns,i=t.changedPath.isActive()?t.changedPath.getNotValueColumnsForNode(e,t.valueColumns):null,a=this.getValuesNormal(e,r),s=e.aggData;return r.forEach((function(t,r){n[t.getId()]=o.aggregateValues(a[r],t.getAggFunc(),t,e)})),i&&s&&i.forEach((function(e){n[e.getId()]=s[e.getId()]})),n},r.prototype.getValuesPivotNonLeaf=function(e,t){var o=[];return e.childrenAfterFilter.forEach((function(e){var n=e.aggData[t];o.push(n)})),o},r.prototype.getValuesFromMappedSet=function(e,t,o){var n=this,r=e;if(t.forEach((function(e){return r=r?r[e]:null})),!r)return[];var i=[];return r.forEach((function(e){var t=n.valueService.getValue(o,e);i.push(t)})),i},r.prototype.getValuesNormal=function(e,t){var o=[];t.forEach((function(){return o.push([])}));for(var n=t.length,r=this.filteredOnly?e.childrenAfterFilter:e.childrenAfterGroup,i=r.length,a=0;a<i;a++)for(var s=r[a],u=0;u<n;u++){var l=t[u],p=this.valueService.getValue(l,s);o[u].push(p)}return o},r.prototype.aggregateValues=function(t,o,n,r){var i="string"==typeof o?this.aggFuncService.getAggFunc(o):o;if("function"!=typeof i)return console.error("AG Grid: unrecognised aggregation function "+o),null;var a=function(){e.doOnce((function(){console.warn("AG Grid: since v24.0, custom aggregation functions take a params object. Please alter your aggregation function to use params.values")}),"aggregationStage.aggregateValues Deprecation")};return i({values:t,column:n,colDef:n?n.getColDef():void 0,rowNode:r,data:r?r.data:void 0,api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext(),forEach:function(e,o){return a(),t.forEach(e,o)},get length(){return a(),t.length},set length(e){a(),t.length=e}})},N([t("columnModel")],r.prototype,"columnModel",void 0),N([t("valueService")],r.prototype,"valueService",void 0),N([t("pivotStage")],r.prototype,"pivotStage",void 0),N([t("aggFuncService")],r.prototype,"aggFuncService",void 0),N([t("gridApi")],r.prototype,"gridApi",void 0),N([t("columnApi")],r.prototype,"columnApi",void 0),r=N([o("aggregationStage")],r)}(n),_=function(){function e(){this.allSets={},this.allParents=[]}return e.prototype.removeFromChildrenAfterGroup=function(e,t){this.getSet(e).removeFromChildrenAfterGroup[t.id]=!0},e.prototype.removeFromAllLeafChildren=function(e,t){this.getSet(e).removeFromAllLeafChildren[t.id]=!0},e.prototype.getSet=function(e){return this.allSets[e.id]||(this.allSets[e.id]={removeFromAllLeafChildren:{},removeFromChildrenAfterGroup:{}},this.allParents.push(e)),this.allSets[e.id]},e.prototype.getAllParents=function(){return this.allParents},e.prototype.flush=function(){var e=this;this.allParents.forEach((function(t){var o=e.allSets[t.id];t.childrenAfterGroup=t.childrenAfterGroup.filter((function(e){return!o.removeFromChildrenAfterGroup[e.id]})),t.allLeafChildren=t.allLeafChildren.filter((function(e){return!o.removeFromAllLeafChildren[e.id]})),t.updateHasChildren(),t.sibling&&(t.sibling.childrenAfterGroup=t.childrenAfterGroup,t.sibling.allLeafChildren=t.allLeafChildren)})),this.allSets={},this.allParents.length=0},e}(),b=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),S=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},F=function(n){function s(){var e=null!==n&&n.apply(this,arguments)||this;return e.groupIdSequence=new r,e}return b(s,n),s.prototype.postConstruct=function(){this.usingTreeData=this.gridOptionsWrapper.isTreeData(),this.usingTreeData&&(this.getDataPath=this.gridOptionsWrapper.getDataPathFunc())},s.prototype.execute=function(e){var t=this.createGroupingDetails(e);if(t.transactions)this.handleTransaction(t);else{var o=!0===e.afterColumnsChanged;this.shotgunResetEverything(t,o)}this.sortGroupsWithComparator(t.rootNode),this.selectableService.updateSelectableAfterGrouping(t.rootNode)},s.prototype.createGroupingDetails=function(e){var t=e.rowNode,o=e.changedPath,n=e.rowNodeTransactions,r=e.rowNodeOrder,i=this.usingTreeData?null:this.columnModel.getRowGroupColumns();return{includeParents:!this.gridOptionsWrapper.isSuppressParentsInRowNodes(),expandByDefault:this.gridOptionsWrapper.getGroupDefaultExpanded(),groupedCols:i,rootNode:t,pivotMode:this.columnModel.isPivotMode(),groupedColCount:this.usingTreeData||!i?0:i.length,rowNodeOrder:r,transactions:n,changedPath:o}},s.prototype.handleTransaction=function(t){var o=this;t.transactions.forEach((function(n){var r=o.usingTreeData?void 0:new _;if(e.existsAndNotEmpty(n.remove)&&o.removeNodes(n.remove,t,r),e.existsAndNotEmpty(n.update)&&o.moveNodesInWrongPath(n.update,t,r),e.existsAndNotEmpty(n.add)&&o.insertNodes(n.add,t,!1),r){var i=r.getAllParents().slice();r.flush(),o.removeEmptyGroups(i,t)}})),t.rowNodeOrder&&this.sortChildren(t)},s.prototype.sortChildren=function(t){t.changedPath.forEachChangedNodeDepthFirst((function(o){e.sortRowNodesByOrder(o.childrenAfterGroup,t.rowNodeOrder)}))},s.prototype.sortGroupsWithComparator=function(t){if(!this.usingTreeData){var o=this.gridOptionsWrapper.getInitialGroupOrderComparator();e.exists(o)&&function t(n){e.exists(n.childrenAfterGroup)&&!n.leafGroup&&(n.childrenAfterGroup.sort((function(e,t){return o({nodeA:e,nodeB:t})})),n.childrenAfterGroup.forEach((function(e){return t(e)})))}(t)}},s.prototype.getExistingPathForNode=function(e,t){for(var o=[],n=this.usingTreeData?e:e.parent;n&&n!==t.rootNode;)o.push({key:n.key,rowGroupColumn:n.rowGroupColumn,field:n.field}),n=n.parent;return o.reverse(),o},s.prototype.moveNodesInWrongPath=function(t,o,n){var r=this;t.forEach((function(t){o.changedPath.isActive()&&o.changedPath.addParentNode(t.parent);var i=function(e){return e.key},a=r.getExistingPathForNode(t,o).map(i),s=r.getGroupInfo(t,o).map(i);e.areEqual(a,s)||r.moveNode(t,o,n)}))},s.prototype.moveNode=function(e,t,o){if(this.removeNodesInStages([e],t,o),this.insertOneNode(e,t,!0),e.setData(e.data),t.changedPath.isActive()){var n=e.parent;t.changedPath.addParentNode(n)}},s.prototype.removeNodes=function(e,t,o){this.removeNodesInStages(e,t,o),t.changedPath.isActive()&&e.forEach((function(e){return t.changedPath.addParentNode(e.parent)}))},s.prototype.removeNodesInStages=function(e,t,o){if(this.removeNodesFromParents(e,t,o),this.usingTreeData){this.postRemoveCreateFillerNodes(e,t);var n=e.map((function(e){return e.parent}));this.removeEmptyGroups(n,t)}},s.prototype.forEachParentGroup=function(e,t,o){for(var n=t;n&&n!==e.rootNode;)o(n),n=n.parent},s.prototype.removeNodesFromParents=function(e,t,o){var n=this,r=null==o,i=o||new _;e.forEach((function(e){n.removeFromParent(e,i),n.forEachParentGroup(t,e.parent,(function(t){i.removeFromAllLeafChildren(t,e)}))})),r&&i.flush()},s.prototype.postRemoveCreateFillerNodes=function(e,t){var o=this;e.forEach((function(e){if(e.hasChildren()){var n=o.getExistingPathForNode(e,t),r=o.findParentForNode(e,n,t);r.expanded=e.expanded,r.allLeafChildren=e.allLeafChildren,r.childrenAfterGroup=e.childrenAfterGroup,r.childrenMapped=e.childrenMapped,r.updateHasChildren(),r.childrenAfterGroup.forEach((function(e){return e.parent=r}))}}))},s.prototype.removeEmptyGroups=function(e,t){for(var o=this,n=!0,r=function(){n=!1;var r=new _;e.forEach((function(e){o.forEachParentGroup(t,e,(function(e){(function(e){var t=o.getChildrenMappedKey(e.key,e.rowGroupColumn),n=e.parent;return!(!n||!n.childrenMapped||!n.childrenMapped[t])&&!!e.isEmptyRowGroupNode()})(e)&&(n=!0,o.removeFromParent(e,r),e.setSelected(!1))}))})),r.flush()};n;)r()},s.prototype.removeFromParent=function(t,o){t.parent&&(o?o.removeFromChildrenAfterGroup(t.parent,t):(e.removeFromArray(t.parent.childrenAfterGroup,t),t.parent.updateHasChildren()));var n=this.getChildrenMappedKey(t.key,t.rowGroupColumn);t.parent&&t.parent.childrenMapped&&(t.parent.childrenMapped[n]=void 0),t.setRowTop(null),t.setRowIndex(null)},s.prototype.addToParent=function(e,t){var o=this.getChildrenMappedKey(e.key,e.rowGroupColumn);t&&(null!=t.childrenMapped&&(t.childrenMapped[o]=e),t.childrenAfterGroup.push(e),t.updateHasChildren())},s.prototype.areGroupColsEqual=function(t,o){return null!=t&&null!=o&&t.pivotMode===o.pivotMode&&e.areEqual(t.groupedCols,o.groupedCols)},s.prototype.checkAllGroupDataAfterColsChanged=function(e){var t=this,o=function(e){e&&e.forEach((function(e){if(!(!t.usingTreeData&&!e.group)){var n={field:e.field,key:e.key,rowGroupColumn:e.rowGroupColumn};t.setGroupData(e,n),o(e.childrenAfterGroup)}}))};o(e.rootNode.childrenAfterGroup)},s.prototype.shotgunResetEverything=function(e,t){if(!this.noChangeInGroupingColumns(e,t)){this.selectionService.removeGroupsFromSelection();var o=e.rootNode,n=e.groupedCols;o.leafGroup=!this.usingTreeData&&0===n.length,o.childrenAfterGroup=[],o.childrenMapped={},o.updateHasChildren();var r=o.sibling;r&&(r.childrenAfterGroup=o.childrenAfterGroup,r.childrenMapped=o.childrenMapped),this.insertNodes(o.allLeafChildren,e,!1)}},s.prototype.noChangeInGroupingColumns=function(e,t){var o=!1,n=this.columnModel.getGroupDisplayColumns(),r=n?n.map((function(e){return e.getId()})).join("-"):"";return t&&(o=this.usingTreeData||this.areGroupColsEqual(e,this.oldGroupingDetails),this.oldGroupDisplayColIds!==r&&this.checkAllGroupDataAfterColsChanged(e)),this.oldGroupingDetails=e,this.oldGroupDisplayColIds=r,o},s.prototype.insertNodes=function(e,t,o){var n=this;e.forEach((function(e){n.insertOneNode(e,t,o),t.changedPath.isActive()&&t.changedPath.addParentNode(e.parent)}))},s.prototype.insertOneNode=function(e,t,o){var n=this.getGroupInfo(e,t),r=this.findParentForNode(e,n,t);r.group||console.warn("AG Grid: duplicate group keys for row data, keys should be unique",[r.data,e.data]),this.usingTreeData?this.swapGroupWithUserNode(r,e,o):(e.parent=r,e.level=n.length,r.childrenAfterGroup.push(e),r.updateHasChildren())},s.prototype.findParentForNode=function(e,t,o){var n=this,r=o.rootNode;return t.forEach((function(t,i){(r=n.getOrCreateNextNode(r,t,i,o)).allLeafChildren.push(e)})),r},s.prototype.swapGroupWithUserNode=function(e,t,o){t.parent=e.parent,t.key=e.key,t.field=e.field,t.groupData=e.groupData,t.level=e.level,o||(t.expanded=e.expanded),t.leafGroup=e.leafGroup,t.rowGroupIndex=e.rowGroupIndex,t.allLeafChildren=e.allLeafChildren,t.childrenAfterGroup=e.childrenAfterGroup,t.childrenMapped=e.childrenMapped,t.updateHasChildren(),this.removeFromParent(e),t.childrenAfterGroup.forEach((function(e){return e.parent=t})),this.addToParent(t,e.parent)},s.prototype.getOrCreateNextNode=function(e,t,o,n){var r=this.getChildrenMappedKey(t.key,t.rowGroupColumn),i=e.childrenMapped?e.childrenMapped[r]:void 0;return i||(i=this.createGroup(t,e,o,n),this.addToParent(i,e)),i},s.prototype.createGroup=function(e,t,o,n){var r=new i(this.beans);return r.group=!0,r.field=e.field,r.rowGroupColumn=e.rowGroupColumn,this.setGroupData(r,e),r.id=i.ID_PREFIX_ROW_GROUP+this.groupIdSequence.next(),r.key=e.key,r.level=o,r.leafGroup=!this.usingTreeData&&o===n.groupedColCount-1,r.allLeafChildren=[],r.setAllChildrenCount(0),r.rowGroupIndex=this.usingTreeData?null:o,r.childrenAfterGroup=[],r.childrenMapped={},r.updateHasChildren(),r.parent=n.includeParents?t:null,this.setExpandedInitialValue(n,r),r},s.prototype.setGroupData=function(e,t){var o=this;e.groupData={},this.columnModel.getGroupDisplayColumns().forEach((function(n){(o.usingTreeData||!!e.rowGroupColumn&&n.isRowGroupDisplayed(e.rowGroupColumn.getId()))&&(e.groupData[n.getColId()]=t.key)}))},s.prototype.getChildrenMappedKey=function(e,t){return t?t.getId()+"-"+e:e},s.prototype.setExpandedInitialValue=function(e,t){if(e.pivotMode&&t.leafGroup)t.expanded=!1;else{var o=this.gridOptionsWrapper.getIsGroupOpenByDefaultFunc();if(o){var n={rowNode:t,field:t.field,key:t.key,level:t.level,rowGroupColumn:t.rowGroupColumn};t.expanded=1==o(n)}else{var r=e.expandByDefault;-1!==e.expandByDefault?t.expanded=t.level<r:t.expanded=!0}}},s.prototype.getGroupInfo=function(e,t){return this.usingTreeData?this.getGroupInfoFromCallback(e):this.getGroupInfoFromGroupColumns(e,t)},s.prototype.getGroupInfoFromCallback=function(t){var o=this.getDataPath?this.getDataPath(t.data):null;null!=o&&0!==o.length||e.doOnce((function(){return console.warn("AG Grid: getDataPath() should not return an empty path for data",t.data)}),"groupStage.getGroupInfoFromCallback");return o?o.map((function(e){return{key:e,field:null,rowGroupColumn:null}})):[]},s.prototype.getGroupInfoFromGroupColumns=function(e,t){var o=this,n=[];return t.groupedCols.forEach((function(r){var i=o.valueService.getKeyForNode(r,e),a=null!=i;if(t.pivotMode&&!a&&(i=" ",a=!0),a){var s={key:i,field:r.getColDef().field,rowGroupColumn:r};n.push(s)}})),n},S([t("columnModel")],s.prototype,"columnModel",void 0),S([t("selectableService")],s.prototype,"selectableService",void 0),S([t("valueService")],s.prototype,"valueService",void 0),S([t("beans")],s.prototype,"beans",void 0),S([t("selectionService")],s.prototype,"selectionService",void 0),S([a],s.prototype,"postConstruct",null),s=S([o("groupStage")],s)}(n),T=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),M=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},w=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},I=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e},R=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}var i;return T(r,n),i=r,r.prototype.createPivotColumnDefs=function(t){var o=[],n=[],r=this.columnModel.getPivotColumns(),i=this.columnModel.getValueColumns(),a=r.length;return this.recursivelyAddGroup(o,n,1,t,[],a,r),this.addRowGroupTotals(o,n,i),this.addExpandablePivotGroups(o,n),this.addPivotTotalsToGroups(o,n),{pivotColumnGroupDefs:o,pivotColumnDefs:n.map((function(t){return e.cloneObject(t)}))}},r.prototype.recursivelyAddGroup=function(t,o,n,r,i,a,s){var u=this;e.iterateObject(r,(function(e,r){var l=I(i,[e]);if(n!==a){var p={children:[],headerName:e,pivotKeys:l,columnGroupShow:"open",groupId:u.generateColumnGroupId(l)};t.push(p),u.recursivelyAddGroup(p.children,o,n+1,r,l,a,s)}else{var c=u.columnModel.getValueColumns(),d={children:[],headerName:e,pivotKeys:l,columnGroupShow:"open",groupId:u.generateColumnGroupId(l)};if(0===c.length){var h=u.createColDef(null,"-",l);d.children.push(h),o.push(h)}else c.forEach((function(e){var t=u.columnModel.getDisplayNameForColumn(e,"header"),n=u.createColDef(e,t,l);n.columnGroupShow="open",d.children.push(n),o.push(n)}));t.push(d)}}));var l=s[n-1].getColDef().pivotComparator,p=this.headerNameComparator.bind(this,l);t.sort(p)},r.prototype.addExpandablePivotGroups=function(e,t){var o=this;if(!this.gridOptionsWrapper.isSuppressExpandablePivotGroups()&&!this.gridOptionsWrapper.getPivotColumnGroupTotals()){var n=function(e,t,r){var i=e;if(i.children){var a=new Map;i.children.forEach((function(e){n(e,t,a)}));var s=!i.children.some((function(e){return e.children}));o.columnModel.getValueColumns().forEach((function(n){var r=o.columnModel.getDisplayNameForColumn(n,"header"),i=o.createColDef(n,r,e.pivotKeys);(i.pivotTotalColumnIds=a.get(n.getColId()),i.columnGroupShow="closed",i.aggFunc=n.getAggFunc(),s)||(e.children.push(i),t.push(i))})),o.merge(r,a)}else{var u=e;if(!u.pivotValueColumn)return;var l=u.pivotValueColumn.getColId(),p=r.has(l)?r.get(l):[];p.push(u.colId),r.set(l,p)}};e.forEach((function(e){n(e,t,new Map)}))}},r.prototype.addPivotTotalsToGroups=function(e,t){var o=this;if(this.gridOptionsWrapper.getPivotColumnGroupTotals()){var n="after"===this.gridOptionsWrapper.getPivotColumnGroupTotals(),r=this.columnModel.getValueColumns(),i=r.map((function(e){return e.getAggFunc()}));if(i&&!(i.length<1)&&this.sameAggFuncs(i)){var a=r[0];e.forEach((function(e){o.recursivelyAddPivotTotal(e,t,a,n)}))}}},r.prototype.recursivelyAddPivotTotal=function(e,t,o,n){var r=this,i=e;if(!i.children){var a=e;return a.colId?[a.colId]:null}var s=[];if(i.children.forEach((function(e){var i=r.recursivelyAddPivotTotal(e,t,o,n);i&&(s=s.concat(i))})),i.children.length>1){var u=this.gridOptionsWrapper.getLocaleTextFunc()("pivotColumnGroupTotals","Total"),l=this.createColDef(o,u,e.pivotKeys);l.pivotTotalColumnIds=s,l.aggFunc=o.getAggFunc();var p=e.children;n?p.push(l):p.unshift(l),t.push(l)}return s},r.prototype.addRowGroupTotals=function(e,t,o){var n=this;if(this.gridOptionsWrapper.getPivotRowTotals())for(var r="after"===this.gridOptionsWrapper.getPivotRowTotals(),i=r?o.slice():o.slice().reverse(),a=function(o){var a=i[o],u=[];e.forEach((function(e){u=u.concat(n.extractColIdsForValueColumn(e,a))})),s.createRowGroupTotal(e,t,[],a,u,r)},s=this,u=0;u<i.length;u++)a(u)},r.prototype.extractColIdsForValueColumn=function(e,t){var o=this,n=e;if(!n.children){var r=n;return r.pivotValueColumn===t&&r.colId?[r.colId]:[]}var i=[];return n.children.forEach((function(e){o.extractColIdsForValueColumn(e,t);var n=o.extractColIdsForValueColumn(e,t);i=i.concat(n)})),i},r.prototype.createRowGroupTotal=function(e,t,o,n,r,a){var s=o.slice(0),u=this.columnModel.getValueColumns(),l={children:[],pivotKeys:s,groupId:i.PIVOT_ROW_TOTAL_PREFIX+"_"+this.generateColumnGroupId(s)};if(0===u.length){var p=this.createColDef(null,"-",s);l.children.push(p),t.push(p)}else{var c=this.columnModel.getDisplayNameForColumn(n,"header");(p=this.createColDef(n,c,s)).pivotTotalColumnIds=r,l.children.push(p),t.push(p)}a?e.push(l):e.unshift(l)},r.prototype.createColDef=function(e,t,o){var n={};if(e){var r=e.getColDef();Object.assign(n,r),n.hide=!1}return n.headerName=t,n.colId=this.generateColumnId(o||[],e?e.getColId():""),n.field=n.colId,n.pivotKeys=o,n.pivotValueColumn=e,!0===n.filter&&(n.filter="agNumberColumnFilter"),n},r.prototype.sameAggFuncs=function(e){if(1==e.length)return!0;for(var t=1;t<e.length;t++)if(e[t]!==e[0])return!1;return!0},r.prototype.headerNameComparator=function(e,t,o){return e?e(t.headerName,o.headerName):t.headerName&&!o.headerName?1:!t.headerName&&o.headerName?-1:t.headerName&&o.headerName?t.headerName<o.headerName?-1:t.headerName>o.headerName?1:0:0},r.prototype.merge=function(e,t){t.forEach((function(t,o,n){var r=e.has(o)?e.get(o):[],i=I(r,t);e.set(o,i)}))},r.prototype.generateColumnGroupId=function(e){return"pivotGroup_"+this.columnModel.getPivotColumns().map((function(e){return e.getColId()})).join("-")+"_"+e.join("-")+"}"},r.prototype.generateColumnId=function(e,t){return"pivot_"+this.columnModel.getPivotColumns().map((function(e){return e.getColId()})).join("-")+"_"+e.join("-")+"_"+t},r.PIVOT_ROW_TOTAL_PREFIX="PivotRowTotal_",M([t("columnModel")],r.prototype,"columnModel",void 0),r=i=M([o("pivotColDefService")],r)}(n),L=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),x=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},V=function(n){function r(){var e=null!==n&&n.apply(this,arguments)||this;return e.uniqueValues={},e}return L(r,n),r.prototype.execute=function(e){var t=e.rowNode,o=e.changedPath;this.columnModel.isPivotActive()?this.executePivotOn(t,o):this.executePivotOff(o)},r.prototype.executePivotOff=function(e){this.aggregationColumnsHashLastTime=null,this.uniqueValues={},this.columnModel.isSecondaryColumnsPresent()&&(this.columnModel.setSecondaryColumns(null,"rowModelUpdated"),e&&e.setInactive())},r.prototype.executePivotOn=function(e,t){var o=this.bucketUpRowNodes(e),n=this.setUniqueValues(o),r=this.columnModel.getValueColumns(),i=r.map((function(e){return e.getId()+"-"+e.getColDef().headerName})).join("#"),a=r.map((function(e){return e.getAggFunc().toString()})).join("#"),s=this.aggregationColumnsHashLastTime!==i,u=this.aggregationFuncsHashLastTime!==a;if(this.aggregationColumnsHashLastTime=i,this.aggregationFuncsHashLastTime=a,n||s||u){var l=this.pivotColDefService.createPivotColumnDefs(this.uniqueValues),p=l.pivotColumnGroupDefs,c=l.pivotColumnDefs;this.pivotColumnDefs=c,this.columnModel.setSecondaryColumns(p,"rowModelUpdated"),t&&t.setInactive()}},r.prototype.setUniqueValues=function(e){return!!(JSON.stringify(e)!==JSON.stringify(this.uniqueValues))&&(this.uniqueValues=e,!0)},r.prototype.bucketUpRowNodes=function(e){var t=this,o={},n=function(e){e.leafGroup?t.bucketRowNode(e,o):e.childrenAfterFilter.forEach((function(e){n(e)}))};return n(e),o},r.prototype.bucketRowNode=function(e,t){var o=this.columnModel.getPivotColumns();0===o.length?e.childrenMapped=null:e.childrenMapped=this.bucketChildren(e.childrenAfterFilter,o,0,t),e.sibling&&(e.sibling.childrenMapped=e.childrenMapped)},r.prototype.bucketChildren=function(t,o,n,r){var i=this,a={},s=o[n];if(t.forEach((function(t){var o=i.valueService.getKeyForNode(s,t);e.missing(o)&&(o=""),r[o]||(r[o]={}),a[o]||(a[o]=[]),a[o].push(t)})),n===o.length-1)return a;var u={};return e.iterateObject(a,(function(e,t){u[e]=i.bucketChildren(t,o,n+1,r[e])})),u},r.prototype.getPivotColumnDefs=function(){return this.pivotColumnDefs},x([t("valueService")],r.prototype,"valueService",void 0),x([t("columnModel")],r.prototype,"columnModel",void 0),x([t("pivotColDefService")],r.prototype,"pivotColDefService",void 0),r=x([o("pivotStage")],r)}(n),W=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),j=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},U="undefined"==typeof BigInt?null:BigInt,k=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.aggFuncsMap={},e.initialised=!1,e}var r;return W(n,t),r=n,n.prototype.init=function(){this.initialised||(this.initialiseWithDefaultAggregations(),this.addAggFuncs(this.gridOptionsWrapper.getAggFuncs()))},n.prototype.initialiseWithDefaultAggregations=function(){this.aggFuncsMap[r.AGG_SUM]=H,this.aggFuncsMap[r.AGG_FIRST]=B,this.aggFuncsMap[r.AGG_LAST]=z,this.aggFuncsMap[r.AGG_MIN]=q,this.aggFuncsMap[r.AGG_MAX]=K,this.aggFuncsMap[r.AGG_COUNT]=X,this.aggFuncsMap[r.AGG_AVG]=Z,this.initialised=!0},n.prototype.getDefaultAggFunc=function(t){var o=this.getFuncNames(t),n=e.includes(o,r.AGG_SUM),i=e.exists(this.aggFuncsMap[r.AGG_SUM]);return n&&i?r.AGG_SUM:e.existsAndNotEmpty(o)?o[0]:null},n.prototype.addAggFuncs=function(t){e.iterateObject(t,this.addAggFunc.bind(this))},n.prototype.addAggFunc=function(e,t){this.init(),this.aggFuncsMap[e]=t},n.prototype.getAggFunc=function(e){return this.init(),this.aggFuncsMap[e]},n.prototype.getFuncNames=function(e){var t=e.getColDef().allowedAggFuncs;return null==t?Object.keys(this.aggFuncsMap).sort():t},n.prototype.clear=function(){this.aggFuncsMap={}},n.AGG_SUM="sum",n.AGG_FIRST="first",n.AGG_LAST="last",n.AGG_MIN="min",n.AGG_MAX="max",n.AGG_COUNT="count",n.AGG_AVG="avg",j([a],n.prototype,"init",null),n=r=j([o("aggFuncService")],n)}(n);function H(e){for(var t=e.values,o=null,n=0;n<t.length;n++){var r=t[n];"number"==typeof r?null===o?o=r:o+=U?"number"==typeof o?r:U(r):r:"bigint"==typeof r&&(o=null===o?r:("bigint"==typeof o?o:U(o))+r)}return o}function B(e){return e.values.length>0?e.values[0]:null}function z(t){return t.values.length>0?e.last(t.values):null}function q(e){for(var t=e.values,o=null,n=0;n<t.length;n++){var r=t[n];"number"!=typeof r&&"bigint"!=typeof r||!(null===o||o>r)||(o=r)}return o}function K(e){for(var t=e.values,o=null,n=0;n<t.length;n++){var r=t[n];"number"!=typeof r&&"bigint"!=typeof r||!(null===o||o<r)||(o=r)}return o}function X(e){for(var t=e.values,o=0,n=0;n<t.length;n++){var r=t[n];o+=null!=r&&"number"==typeof r.value?r.value:1}return{value:o,toString:function(){return this.value.toString()},toNumber:function(){return this.value}}}function Z(e){for(var t=e.values,o=0,n=0,r=0;r<t.length;r++){var i=t[r],a=null;"number"==typeof i||"bigint"==typeof i?(a=i,n++):null==i||"number"!=typeof i.value&&"bigint"!=typeof i.value||"number"!=typeof i.count||(a=U?i.value*("number"==typeof i.value?i.count:U(i.count)):i.value*i.count,n+=i.count),"number"==typeof a?o+=U?"number"==typeof o?a:U(a):a:"bigint"==typeof a&&(o=("bigint"==typeof o?o:U(o))+a)}var s=null;return n>0&&(s=U?o/("number"==typeof o?n:U(n)):o/n),{count:n,value:s,toString:function(){return"number"==typeof this.value||"bigint"==typeof this.value?this.value.toString():""},toNumber:function(){return this.value}}}var Y=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Q=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},J=function(o){function n(e,t,n,r,i){var a=o.call(this)||this;return a.column=e,a.dragSourceDropTarget=t,a.ghost=n,a.valueColumn=r,a.horizontal=i,a.popupShowing=!1,a}return Y(n,o),n.prototype.init=function(){this.setTemplate(n.TEMPLATE);var t=this.getGui(),o=this.gridOptionsWrapper.isFunctionsReadOnly();this.addElementClasses(t),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(e.createIconNoSpan("columnDrag",this.gridOptionsWrapper)),this.eButton.appendChild(e.createIconNoSpan("cancel",this.gridOptionsWrapper)),this.displayName=this.columnModel.getDisplayNameForColumn(this.column,"columnDrop"),this.setupComponents(),this.ghost||o||this.addDragSource();var r=this.gridOptionsWrapper.getLocaleTextFunc(),i=r("ariaDropZoneColumnComponentDescription","Press DELETE to remove"),a=this.getColumnAndAggFuncName(),s=a.name,u=a.aggFuncName,l="";this.valueColumn&&!o&&(l=r("ariaDropZoneColumnValueItemDescription","Press ENTER to change the aggregation type")),e.setAriaLabel(t,u+" "+s+" "+i+" "+l),this.setupTooltip()},n.prototype.setupTooltip=function(){var e=this,t=function(){var t=e.column.getColDef().headerTooltip;e.setTooltip(t)};t(),this.addManagedListener(this.eventService,s.EVENT_NEW_COLUMNS_LOADED,t)},n.prototype.addDragSource=function(){var e=this,t={type:u.ToolPanel,eElement:this.eDragHandle,defaultIconName:l.ICON_HIDE,getDragItem:function(){return e.createDragItem()},dragItemName:this.displayName,dragSourceDropTarget:this.dragSourceDropTarget};this.dragAndDropService.addDragSource(t,!0),this.addDestroyFunc((function(){return e.dragAndDropService.removeDragSource(t)}))},n.prototype.createDragItem=function(){var e={};return e[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:e}},n.prototype.setupComponents=function(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost"),this.valueColumn&&!this.gridOptionsWrapper.isFunctionsReadOnly()&&this.addGuiEventListener("click",this.onShowAggFuncSelection.bind(this))},n.prototype.setupRemove=function(){var t=this;e.setDisplayed(this.eButton,!this.gridOptionsWrapper.isFunctionsReadOnly());var o={type:n.EVENT_COLUMN_REMOVE};this.addGuiEventListener("keydown",(function(e){var n=e.key===p.ENTER;e.key===p.DELETE&&(e.preventDefault(),t.dispatchEvent(o)),n&&t.valueColumn&&!t.gridOptionsWrapper.isFunctionsReadOnly()&&(e.preventDefault(),t.onShowAggFuncSelection())})),this.addManagedListener(this.eButton,"click",(function(e){t.dispatchEvent(o),e.stopPropagation()}));var r=new c(this.eButton);this.addManagedListener(r,c.EVENT_TAP,(function(){t.dispatchEvent(o)})),this.addDestroyFunc(r.destroy.bind(r))},n.prototype.getColumnAndAggFuncName=function(){var e=this.displayName,t="";if(this.valueColumn){var o=this.column.getAggFunc(),n="string"==typeof o?o:"agg";t=this.gridOptionsWrapper.getLocaleTextFunc()(n,n)}return{name:e,aggFuncName:t}},n.prototype.setTextValue=function(){var t=this.getColumnAndAggFuncName(),o=t.name,n=t.aggFuncName,r=this.valueColumn?n+"("+o+")":o,i=e.escapeString(r);this.eText.innerHTML=i},n.prototype.onShowAggFuncSelection=function(){var t=this;if(!this.popupShowing){this.popupShowing=!0;var o=new d("select-agg-func"),n=this.aggFuncService.getFuncNames(this.column),r=this.getGui(),i=o.getGui();o.setModel({getRow:function(e){return n[e]},getRowCount:function(){return n.length}}),this.getContext().createBean(o);var a=e.loadTemplate('<div class="ag-select-agg-func-popup"></div>');a.style.top="0px",a.style.left="0px",a.appendChild(i),a.style.width=r.clientWidth+"px";var s=this.gridOptionsWrapper.getLocaleTextFunc(),u=this.popupService.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:function(){t.destroyBean(o),t.popupShowing=!1,r.focus()},ariaLabel:s("ariaLabelAggregationFunction","Aggregation Function")});u&&o.setComponentCreator(this.createAggSelect.bind(this,u.hideFunc)),o.addGuiEventListener("keydown",(function(e){if(e.key===p.ENTER||e.key===p.SPACE){var t=o.getLastFocusedRow();if(null==t)return;var n=o.getComponentAt(t);n&&n.selectItem()}})),this.popupService.positionPopupUnderComponent({type:"aggFuncSelect",eventSource:r,ePopup:a,keepWithinBounds:!0,column:this.column}),o.refresh();var l=n.findIndex((function(e){return e===t.column.getAggFunc()}));-1===l&&(l=0),o.focusRow(l)}},n.prototype.createAggSelect=function(e,t){var o=this,n=this.gridOptionsWrapper.getLocaleTextFunc(),r=t.toString(),i=n(r,r);return new $((function(){if(e(),o.gridOptionsWrapper.isFunctionsPassive()){var n={type:s.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST,columns:[o.column],aggFunc:t,api:o.gridApi,columnApi:o.columnApi};o.eventService.dispatchEvent(n)}else o.columnModel.setColumnAggFunc(o.column,t,"toolPanelDragAndDrop")}),i)},n.prototype.addElementClasses=function(e,t){t=t?"-"+t:"";var o=this.horizontal?"horizontal":"vertical";e.classList.add("ag-column-drop-cell"+t,"ag-column-drop-"+o+"-cell"+t)},n.EVENT_COLUMN_REMOVE="columnRemove",n.TEMPLATE='<span role="option" tabindex="0">\n          <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>\n          <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>\n          <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>\n        </span>',Q([t("dragAndDropService")],n.prototype,"dragAndDropService",void 0),Q([t("columnModel")],n.prototype,"columnModel",void 0),Q([t("popupService")],n.prototype,"popupService",void 0),Q([h("aggFuncService")],n.prototype,"aggFuncService",void 0),Q([t("columnApi")],n.prototype,"columnApi",void 0),Q([t("gridApi")],n.prototype,"gridApi",void 0),Q([g("eText")],n.prototype,"eText",void 0),Q([g("eDragHandle")],n.prototype,"eDragHandle",void 0),Q([g("eButton")],n.prototype,"eButton",void 0),Q([a],n.prototype,"init",null),n}(f),$=function(e){function t(t,o){var n=e.call(this,'<div class="ag-select-agg-func-item"/>')||this;return n.selectItem=t,n.getGui().innerText=o,n.addGuiEventListener("click",n.selectItem),n}return Y(t,e),t}(f),ee=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),te=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},oe=function(o){function n(t,r){var i=o.call(this,'<div class="ag-unselectable" aria-role="presentation"></div>')||this;return i.horizontal=t,i.valueColumn=r,i.state=n.STATE_NOT_DRAGGING,i.guiDestroyFunctions=[],i.childColumnComponents=[],i.resizeEnabled=!1,i.addElementClasses(i.getGui()),i.eColumnDropList=document.createElement("div"),i.addElementClasses(i.eColumnDropList,"list"),e.setAriaRole(i.eColumnDropList,"listbox"),i}return ee(n,o),n.prototype.isHorizontal=function(){return this.horizontal},n.prototype.toggleResizable=function(e){this.positionableFeature.setResizable(!!e&&{bottom:!0}),this.resizeEnabled=e},n.prototype.setBeans=function(e){this.beans=e},n.prototype.destroy=function(){this.destroyGui(),o.prototype.destroy.call(this)},n.prototype.destroyGui=function(){this.guiDestroyFunctions.forEach((function(e){return e()})),this.guiDestroyFunctions.length=0,this.childColumnComponents.length=0,e.clearElement(this.getGui()),e.clearElement(this.eColumnDropList)},n.prototype.init=function(t){this.params=t,this.createManagedBean(new v(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.addManagedListener(this.beans.eventService,s.EVENT_NEW_COLUMNS_LOADED,this.refreshGui.bind(this)),this.addManagedListener(this.beans.gridOptionsWrapper,"functionsReadOnly",this.refreshGui.bind(this)),this.setupDropTarget(),this.positionableFeature=new m(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),e.setAriaLabel(this.eColumnDropList,this.getAriaLabel())},n.prototype.handleKeyDown=function(e){var t=!this.horizontal,o=e.key===p.DOWN,n=e.key===p.UP;if(!t){var r=this.gridOptionsWrapper.isEnableRtl();o=!r&&e.key===p.RIGHT||r&&e.key===p.LEFT,n=!r&&e.key===p.LEFT||r&&e.key===p.RIGHT}if(o||n){var i=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,n);i&&(e.preventDefault(),i.focus())}},n.prototype.addElementClasses=function(e,t){t=t?"-"+t:"";var o=this.horizontal?"horizontal":"vertical";e.classList.add("ag-column-drop"+t,"ag-column-drop-"+o+t)},n.prototype.setupDropTarget=function(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.beans.dragAndDropService.addDropTarget(this.dropTarget)},n.prototype.isInterestedIn=function(e){return e===u.HeaderCell||e===u.ToolPanel},n.prototype.checkInsertIndex=function(e){var t=this.horizontal?this.getNewHorizontalInsertIndex(e):this.getNewVerticalInsertIndex(e);if(t<0)return!1;var o=t!==this.insertIndex;return o&&(this.insertIndex=t),o},n.prototype.getNewHorizontalInsertIndex=function(t){if(e.missing(t.hDirection))return-1;var o=0,n=t.event,r=this.beans.gridOptionsWrapper.isEnableRtl(),i=t.hDirection===y.Left,a=n.clientX;return this.childColumnComponents.forEach((function(e){var t=e.getGui().getBoundingClientRect(),n=i?t.right:t.left;(r?a<=n:a>=n)&&o++})),o},n.prototype.getNewVerticalInsertIndex=function(t){if(e.missing(t.vDirection))return-1;var o=0,n=t.event;return this.childColumnComponents.forEach((function(e){var r=e.getGui().getBoundingClientRect();n.clientY>=(t.vDirection===C.Down?r.top:r.bottom)&&o++})),o},n.prototype.checkDragStartedBySelf=function(e){this.state===n.STATE_NOT_DRAGGING&&(this.state=n.STATE_REARRANGE_COLUMNS,this.potentialDndColumns=e.dragSource.getDragItem().columns||[],this.refreshGui(),this.checkInsertIndex(e),this.refreshGui())},n.prototype.onDragging=function(e){this.checkDragStartedBySelf(e),this.checkInsertIndex(e)&&this.refreshGui()},n.prototype.onDragEnter=function(e){var t=e.dragSource.getDragItem().columns||[];this.state=n.STATE_NEW_COLUMNS_IN;var o=t.filter(this.isColumnDroppable.bind(this));o.length>0&&(this.potentialDndColumns=o,this.checkInsertIndex(e),this.refreshGui())},n.prototype.isPotentialDndColumns=function(){return e.existsAndNotEmpty(this.potentialDndColumns)},n.prototype.onDragLeave=function(e){if(this.state===n.STATE_REARRANGE_COLUMNS){var t=e.dragSource.getDragItem().columns||[];this.removeColumns(t)}this.isPotentialDndColumns()&&(this.potentialDndColumns=[],this.refreshGui()),this.state=n.STATE_NOT_DRAGGING},n.prototype.onDragStop=function(){if(this.isPotentialDndColumns()){var e=!1;this.state===n.STATE_NEW_COLUMNS_IN?(this.addColumns(this.potentialDndColumns),e=!0):e=this.rearrangeColumns(this.potentialDndColumns),this.potentialDndColumns=[],this.beans.gridOptionsWrapper.isFunctionsPassive()&&e||this.refreshGui()}this.state=n.STATE_NOT_DRAGGING},n.prototype.removeColumns=function(t){var o=this.getExistingColumns().filter((function(o){return!e.includes(t,o)}));this.updateColumns(o)},n.prototype.addColumns=function(t){if(t){var o=this.getExistingColumns().slice(),n=t.filter((function(e){return o.indexOf(e)<0}));e.insertArrayIntoArray(o,n,this.insertIndex),this.updateColumns(o)}},n.prototype.rearrangeColumns=function(t){var o=this.getNonGhostColumns().slice();return e.insertArrayIntoArray(o,t,this.insertIndex),!e.areEqual(o,this.getExistingColumns())&&(this.updateColumns(o),!0)},n.prototype.refreshGui=function(){var e=this.eColumnDropList.scrollTop,t=this.resizeEnabled,o=this.getFocusedItem(),n=this.focusService.findNextFocusableElement();n||(n=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addColumnsToGui(),this.isHorizontal()||(this.eColumnDropList.scrollTop=e),t&&this.toggleResizable(t),this.restoreFocus(o,n)},n.prototype.getFocusedItem=function(){var e=this.getGui(),t=this.gridOptionsWrapper.getDocument().activeElement;return e.contains(t)?Array.from(e.querySelectorAll(".ag-column-drop-cell")).indexOf(t):-1},n.prototype.restoreFocus=function(e,t){var o=this.getGui(),n=Array.from(o.querySelectorAll(".ag-column-drop-cell"));if(-1!==e){0===n.length&&t.focus();var r=n[Math.min(n.length-1,e)];r&&r.focus()}},n.prototype.getNonGhostColumns=function(){var t=this,o=this.getExistingColumns();return this.isPotentialDndColumns()?o.filter((function(o){return!e.includes(t.potentialDndColumns,o)})):o},n.prototype.addColumnsToGui=function(){var e=this,t=this.getNonGhostColumns(),o=this.isPotentialDndColumns(),n=[];t.forEach((function(t,r){if(!(o&&r>=e.insertIndex)){var i=e.createColumnComponent(t,!1);n.push(i)}})),this.isPotentialDndColumns()&&(this.potentialDndColumns.forEach((function(t){var o=e.createColumnComponent(t,!0);n.push(o)})),t.forEach((function(t,o){if(!(o<e.insertIndex)){var r=e.createColumnComponent(t,!1);n.push(r)}}))),this.appendChild(this.eColumnDropList),n.forEach((function(t,o){o>0&&e.addArrow(e.eColumnDropList),e.eColumnDropList.appendChild(t.getGui())})),this.addAriaLabelsToComponents()},n.prototype.addAriaLabelsToComponents=function(){var t=this;this.childColumnComponents.forEach((function(o,n){var r=o.getGui();e.setAriaPosInSet(r,n+1),e.setAriaSetSize(r,t.childColumnComponents.length)}))},n.prototype.createColumnComponent=function(e,t){var o=this,n=new J(e,this.dropTarget,t,this.valueColumn,this.horizontal);return n.addEventListener(J.EVENT_COLUMN_REMOVE,this.removeColumns.bind(this,[e])),this.beans.context.createBean(n),this.guiDestroyFunctions.push((function(){return o.destroyBean(n)})),t||this.childColumnComponents.push(n),n},n.prototype.addIconAndTitleToGui=function(){var e=this.params.icon,t=document.createElement("div");if(t.setAttribute("aria-hidden","true"),this.addElementClasses(t,"title-bar"),this.addElementClasses(e,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingColumnsEmpty()),t.appendChild(e),!this.horizontal){var o=document.createElement("span");this.addElementClasses(o,"title"),o.innerHTML=this.params.title,t.appendChild(o)}this.appendChild(t)},n.prototype.isExistingColumnsEmpty=function(){return 0===this.getExistingColumns().length},n.prototype.addEmptyMessageToGui=function(){if(this.isExistingColumnsEmpty()&&!this.isPotentialDndColumns()){var e=document.createElement("span");e.innerHTML=this.params.emptyMessage,this.addElementClasses(e,"empty-message"),this.eColumnDropList.appendChild(e)}},n.prototype.addArrow=function(t){if(this.horizontal){var o=this.beans.gridOptionsWrapper.isEnableRtl(),n=e.createIconNoSpan(o?"smallLeft":"smallRight",this.beans.gridOptionsWrapper);this.addElementClasses(n,"cell-separator"),t.appendChild(n)}},n.STATE_NOT_DRAGGING="notDragging",n.STATE_NEW_COLUMNS_IN="newColumnsIn",n.STATE_REARRANGE_COLUMNS="rearrangeColumns",te([t("focusService")],n.prototype,"focusService",void 0),n}(f),ne=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),re=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ie=function(o){function n(e){return o.call(this,e,!1)||this}return ne(n,o),n.prototype.passBeansUp=function(){o.prototype.setBeans.call(this,{gridOptionsWrapper:this.gridOptionsWrapper,eventService:this.eventService,context:this.getContext(),loggerFactory:this.loggerFactory,dragAndDropService:this.dragAndDropService});var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=t("rowGroupColumnsEmptyMessage","Drag here to set row groups"),r=t("groups","Row Groups");o.prototype.init.call(this,{dragAndDropIcon:l.ICON_GROUP,icon:e.createIconNoSpan("rowGroupPanel",this.gridOptionsWrapper,null),emptyMessage:n,title:r}),this.addManagedListener(this.eventService,s.EVENT_COLUMN_ROW_GROUP_CHANGED,this.refreshGui.bind(this))},n.prototype.getAriaLabel=function(){return this.gridOptionsWrapper.getLocaleTextFunc()("ariaRowGroupDropZonePanelLabel","Row Groups")},n.prototype.getTooltipParams=function(){var e=o.prototype.getTooltipParams.call(this);return e.location="rowGroupColumnsList",e},n.prototype.isColumnDroppable=function(e){return!(this.gridOptionsWrapper.isFunctionsReadOnly()||!e.isPrimary())&&(e.isAllowRowGroup()&&!e.isRowGroupActive())},n.prototype.updateColumns=function(e){if(this.gridOptionsWrapper.isFunctionsPassive()){var t={type:s.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST,columns:e,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}else this.columnModel.setRowGroupColumns(e,"toolPanelUi")},n.prototype.getIconName=function(){return this.isPotentialDndColumns()?l.ICON_GROUP:l.ICON_NOT_ALLOWED},n.prototype.getExistingColumns=function(){return this.columnModel.getRowGroupColumns()},re([t("columnModel")],n.prototype,"columnModel",void 0),re([t("loggerFactory")],n.prototype,"loggerFactory",void 0),re([t("dragAndDropService")],n.prototype,"dragAndDropService",void 0),re([t("columnApi")],n.prototype,"columnApi",void 0),re([t("gridApi")],n.prototype,"gridApi",void 0),re([a],n.prototype,"passBeansUp",null),n}(oe),ae=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),se=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ue=function(o){function n(e){return o.call(this,e,!1)||this}return ae(n,o),n.prototype.passBeansUp=function(){o.prototype.setBeans.call(this,{gridOptionsWrapper:this.gridOptionsWrapper,eventService:this.eventService,context:this.getContext(),loggerFactory:this.loggerFactory,dragAndDropService:this.dragAndDropService});var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=t("pivotColumnsEmptyMessage","Drag here to set column labels"),r=t("pivots","Column Labels");o.prototype.init.call(this,{dragAndDropIcon:l.ICON_GROUP,icon:e.createIconNoSpan("pivotPanel",this.gridOptionsWrapper,null),emptyMessage:n,title:r}),this.addManagedListener(this.eventService,s.EVENT_NEW_COLUMNS_LOADED,this.refresh.bind(this)),this.addManagedListener(this.eventService,s.EVENT_COLUMN_PIVOT_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,s.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.checkVisibility.bind(this)),this.refresh()},n.prototype.getAriaLabel=function(){return this.gridOptionsWrapper.getLocaleTextFunc()("ariaPivotDropZonePanelLabel","Column Labels")},n.prototype.getTooltipParams=function(){var e=o.prototype.getTooltipParams.call(this);return e.location="pivotColumnsList",e},n.prototype.refresh=function(){this.checkVisibility(),this.refreshGui()},n.prototype.checkVisibility=function(){var e=this.columnModel.isPivotMode();if(this.isHorizontal())switch(this.gridOptionsWrapper.getPivotPanelShow()){case"always":this.setDisplayed(e);break;case"onlyWhenPivoting":var t=this.columnModel.isPivotActive();this.setDisplayed(e&&t);break;default:this.setDisplayed(!1)}else this.setDisplayed(e)},n.prototype.isColumnDroppable=function(e){return!(this.gridOptionsWrapper.isFunctionsReadOnly()||!e.isPrimary())&&(e.isAllowPivot()&&!e.isPivotActive())},n.prototype.updateColumns=function(e){if(this.gridOptionsWrapper.isFunctionsPassive()){var t={type:s.EVENT_COLUMN_PIVOT_CHANGE_REQUEST,columns:e,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}else this.columnModel.setPivotColumns(e,"toolPanelUi")},n.prototype.getIconName=function(){return this.isPotentialDndColumns()?l.ICON_PIVOT:l.ICON_NOT_ALLOWED},n.prototype.getExistingColumns=function(){return this.columnModel.getPivotColumns()},se([t("columnModel")],n.prototype,"columnModel",void 0),se([t("loggerFactory")],n.prototype,"loggerFactory",void 0),se([t("dragAndDropService")],n.prototype,"dragAndDropService",void 0),se([t("columnApi")],n.prototype,"columnApi",void 0),se([t("gridApi")],n.prototype,"gridApi",void 0),se([a],n.prototype,"passBeansUp",null),n}(oe),le=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),pe=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ce=function(o){function n(){return o.call(this)||this}return le(n,o),n.prototype.postConstruct=function(){this.setGui(this.createNorthPanel()),this.addManagedListener(this.eventService,s.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,s.EVENT_NEW_COLUMNS_LOADED,this.onRowGroupChanged.bind(this)),this.onRowGroupChanged()},n.prototype.createNorthPanel=function(){var t=document.createElement("div"),o=this.onDropPanelVisible.bind(this);return t.classList.add("ag-column-drop-wrapper"),e.setAriaRole(t,"presentation"),this.rowGroupComp=new ie(!0),this.createManagedBean(this.rowGroupComp),this.pivotComp=new ue(!0),this.createManagedBean(this.pivotComp),t.appendChild(this.rowGroupComp.getGui()),t.appendChild(this.pivotComp.getGui()),this.addManagedListener(this.rowGroupComp,f.EVENT_DISPLAYED_CHANGED,o),this.addManagedListener(this.pivotComp,f.EVENT_DISPLAYED_CHANGED,o),this.onDropPanelVisible(),t},n.prototype.onDropPanelVisible=function(){var e=this.rowGroupComp.isDisplayed()&&this.pivotComp.isDisplayed();this.rowGroupComp.addOrRemoveCssClass("ag-column-drop-horizontal-half-width",e),this.pivotComp.addOrRemoveCssClass("ag-column-drop-horizontal-half-width",e)},n.prototype.onRowGroupChanged=function(){if(this.rowGroupComp){var e=this.gridOptionsWrapper.getRowGroupPanelShow();if(e===A.ALWAYS)this.rowGroupComp.setDisplayed(!0);else if(e===A.ONLY_WHEN_GROUPING){var t=!this.columnModel.isRowGroupEmpty();this.rowGroupComp.setDisplayed(t)}else this.rowGroupComp.setDisplayed(!1)}},pe([t("columnModel")],n.prototype,"columnModel",void 0),pe([a],n.prototype,"postConstruct",null),n}(f),de=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),he=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ge=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return de(n,e),n.prototype.execute=function(e){var t=this,o=this.columnModel.isPivotMode(),n=this.filterManager.isAggregateFilterPresent(),r=this.gridOptionsWrapper.getGroupAggFiltering()||(o?function(e){return e.node.leafGroup}:function(e){return!e.node.group}),i=e.changedPath,a=function(e){if(e.childrenAfterFilter){e.childrenAfterAggFilter=e.childrenAfterFilter;var t=e.childrenAfterAggFilter.reduce((function(e,t){return a(t),e+(t.allChildrenCount||1)}),0);e.setAllChildrenCount(t)}e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)};i.forEachChangedNodeDepthFirst(n?function(e){var o,n=0;e.childrenAfterAggFilter=(null===(o=e.childrenAfterFilter)||void 0===o?void 0:o.filter((function(e){var o;if(r({node:e})&&t.filterManager.doesRowPassAggregateFilters({rowNode:e}))return a(e),n+=e.allChildrenCount||1,!0;return!!(null===(o=e.childrenAfterAggFilter)||void 0===o?void 0:o.length)&&(n+=e.allChildrenCount||1,!0)})))||null,e.setAllChildrenCount(n),e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)}:function(e){e.childrenAfterAggFilter=e.childrenAfterFilter;var t=e.childrenAfterAggFilter.reduce((function(e,t){return e+(t.allChildrenCount||1)}),0);e.setAllChildrenCount(t),e.sibling&&(e.sibling.childrenAfterAggFilter=e.childrenAfterAggFilter)},!1)},he([t("filterManager")],n.prototype,"filterManager",void 0),he([t("columnModel")],n.prototype,"columnModel",void 0),n=he([o("filterAggregatesStage")],n)}(n),fe={moduleName:G.RowGroupingModule,beans:[P,ge,F,R,V,k],agStackComponents:[{componentName:"AgGridHeaderDropZones",componentClass:ce}],dependantModules:[D]},ve=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),me=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},ye=function(o){function n(e){return o.call(this,e,!0)||this}return ve(n,o),n.prototype.passBeansUp=function(){o.prototype.setBeans.call(this,{gridOptionsWrapper:this.gridOptionsWrapper,eventService:this.eventService,context:this.getContext(),loggerFactory:this.loggerFactory,dragAndDropService:this.dragAndDropService});var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=t("valueColumnsEmptyMessage","Drag here to aggregate"),r=t("values","Values");o.prototype.init.call(this,{dragAndDropIcon:l.ICON_AGGREGATE,icon:e.createIconNoSpan("valuePanel",this.gridOptionsWrapper,null),emptyMessage:n,title:r}),this.addManagedListener(this.eventService,s.EVENT_COLUMN_VALUE_CHANGED,this.refreshGui.bind(this))},n.prototype.getAriaLabel=function(){return this.gridOptionsWrapper.getLocaleTextFunc()("ariaValuesDropZonePanelLabel","Values")},n.prototype.getTooltipParams=function(){var e=o.prototype.getTooltipParams.call(this);return e.location="valueColumnsList",e},n.prototype.getIconName=function(){return this.isPotentialDndColumns()?l.ICON_AGGREGATE:l.ICON_NOT_ALLOWED},n.prototype.isColumnDroppable=function(e){return!(this.gridOptionsWrapper.isFunctionsReadOnly()||!e.isPrimary())&&(e.isAllowValue()&&!e.isValueActive())},n.prototype.updateColumns=function(e){if(this.gridOptionsWrapper.isFunctionsPassive()){var t={type:s.EVENT_COLUMN_VALUE_CHANGE_REQUEST,columns:e,api:this.gridApi,columnApi:this.columnApi};this.eventService.dispatchEvent(t)}else this.columnModel.setValueColumns(e,"toolPanelUi")},n.prototype.getExistingColumns=function(){return this.columnModel.getValueColumns()},me([t("columnModel")],n.prototype,"columnModel",void 0),me([t("loggerFactory")],n.prototype,"loggerFactory",void 0),me([t("dragAndDropService")],n.prototype,"dragAndDropService",void 0),me([t("columnApi")],n.prototype,"columnApi",void 0),me([t("gridApi")],n.prototype,"gridApi",void 0),me([a],n.prototype,"passBeansUp",null),n}(oe);export{ue as PivotDropZonePanel,ie as RowGroupDropZonePanel,fe as RowGroupingModule,ye as ValuesDropZonePanel};